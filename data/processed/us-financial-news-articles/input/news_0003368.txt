Spotify wants to sell its shares to public investors this spring. And as part of its prep plans, the streaming music company has cleaned up a sticky debt deal, with the help of a big Chinese tech company.
The short version: TPG and Dragoneer Investment Group, who had led a debt round that lent $1 billion to Spotify, late last year turned some of that debt into equity, which the companies then sold to Tencent, the Chinese internet giant, according to people familiar with the deal.
The complicated transaction let TPG and Dragoneer earn a nice return on their investment. It also allowed Spotify to solve a potentially contentious business dispute before it tries a novel IPO strategy.
More from Recode: 
Trump is always going to be a big story. But in 2018, he can't be the only story. 
Two-day shipping has helped double warehouse land prices 
Didi is buying an Uber competitor in its fastest-growing region 
Longer version: In 2016, TPG, Dragoneer and Goldman Sachs lent Spotify $1 billion via convertible debt financing, which was supposed to give the lenders the ability to eventually turn their loans into equity.
The deal let Spotify bide time before an IPO, but not too much time: The longer Spotify took to go public, the better the terms would get for the lenders. News emerged Wednesday that the company had confidentially filed IPO documents in late December.
But since signing that 2016 deal, Spotify, guided by its chief financial officer Barry McCarthy, began to pursue a direct listing — a largely untested way for Spotify to be traded as a public company without raising any new cash.
That unusual version of an IPO would allow Spotify to save money on banking fees. It also technically didn't qualify as an IPO under the terms of the debt deal, which meant lenders wouldn't be guaranteed the chance to convert their debt into equity.
Enter Tencent, which bought Spotify stock from existing shareholders as part of an equity swap and sale the two companies announced in December.
What wasn't announced was that some of the stock came from TPG and Dragoneer, which converted the debt into equity at about a $10 billion valuation and then sold it to the Chinese conglomerate at about a $20 billion valuation, according to a person familiar with transaction.
TPG and Dragoneer still hold some Spotify debt, according to sources familiar with the companies.
Spotify, Tencent, TPG, and Dragoneer declined to comment.
That deal helped clear the way for Spotify's direct listing. While it's not clear that TPG and Dragoneer had any way to force Spotify to convert their debt, it's in the streaming company's interest to remove as many question marks as possible before its offering, which has already raised eyebrows from regulators .
— By Theodore Schleifer and Peter Kafka, Recode.net . 
CNBC's parent NBCUniversal is an investor in Recode's parent Vox, and the companies have a content-sharing arrangement.
More than a decade before federal agents arrived at Caterpillar Inc. in March with search warrants, an anonymous employee claimed in a letter to its chief executive that something was wrong about how the heavy-machinery maker used a subsidiary in Switzerland to shrink its tax bill.

When customers outside the U.S. need parts for a bulldozer or mining truck, their order often is shipped from a Caterpillar warehouse in Morton, Ill. Nearly all the sales and profits flow through a company subsidiary in Geneva, where the company...  
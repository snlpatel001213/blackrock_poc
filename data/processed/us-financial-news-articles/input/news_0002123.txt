(Adds details on specific stocks, updates prices)
* TSX up 38.63 points, or 0.24 percent, to 16,348.62
* Six of the TSX's 10 main groups move higher
TORONTO, Jan 3 (Reuters) - Canada's main stock index hit a fresh all-time high on Wednesday, boosted by a jump in shares of BlackBerry Ltd after it announced a self-driving deal with China's Baidu and by sharp gains for several marijuana producers.
* At 10:20 a.m. EST (1520 GMT), the Toronto Stock Exchange's S&P/TSX composite index was up 38.63 points, or 0.24 percent, at 16,348.62. Six of its 10 main groups were in positive territory.
* BlackBerry rose 5.4 percent to C$15.83, hitting its highest levels since 2013, after saying that it will provide the foundational operating system for search engine company Baidu's autonomous vehicle platform, the latest in a string of recent automotive design wins.
* Canadian cannabis producers extended sharp rallies as California opened the largest U.S. state market for legal marijuana, with Canada expected to follow by mid-2018. Canopy Growth Corp jumped 6 percent to C$34.32, Aphria Inc was up 5.9 percent at C$21.39 and Aurora Cannabis Inc surged 18 percent to C$13.97.
* Luxury apparel maker Canada Goose Holdings Inc, which went public less than a year ago, was last up 2.9 percent at C$40.92 after hitting an all-time high of C$41.90.
* The energy group climbed 1.0 percent, as oil prices rose to new two-and-a-half year highs. Cenovus Energy was up 3 percent at C$12.55 and Canadian Natural Resources Ltd added 1.2 percent to C$46.30.
* The materials group, which includes precious and base metals miners and fertilizer companies, lost 0.9 percent.
* Valeant Pharmaceuticals International Inc gained 6.7 percent to C$29.07 after announcing it had paid down more of its debt load.
(Reporting by Alastair Sharp; Editing by Susan Thomas)